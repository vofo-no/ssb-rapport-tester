/*! ssb-rapport-tester 2017-01-04 */
(function(){var a,b,c,d,e,f,g,h,i,j,k=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};for(this.onmessage=function(a){return a.data[0]===!1?i():self.postMessage(h(a.data[0],a.data[1]))},this.validator_seen_ids=[],c=[2501,2503,2504,2508,2510,2521,2525,2534,2535,2536,2538,2539,2542,2545,2551],d=[101,102,103,104,105,106,107,108,109,110,111,112,199,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,230,231,232,233,234,298,299,301,302,303,304,305,306,307,308,398,399,401,402,403,404,405,406,407,408,409,410,499,501,502,503,504,505,506,507,508,599,601,602,603,604,605,606,607,608,609,610,611,612,698,699,701,702,703,704,705,706,720,721,722,723,724,799,801,802,803,899,901,902,903,904,905,906,907,908,909,910,911,912,998,999,1001,1002,1003,1004,1005,1006,1007,1020,1099,1101,1102,1103,1104,1105,1199],b=(new Date).getFullYear(),(new Date).getMonth()<4&&(b-=1),a=[2111,2121,2131,2211,2311,2321],e=f=1;22>=f;e=++f)13!==e&&a.push(100*e);j=new XMLHttpRequest,j.onreadystatechange=function(){var b,c,d,e,f;if(j.readyState===XMLHttpRequest.DONE&&200===j.status){for(e=JSON.parse(j.responseText).codes,f=[],b=0,d=e.length;d>b;b++)c=e[b],f.push(a.push(parseInt(c.code)));return f}},j.open("GET","https://data.ssb.no/api/klass/v1/classifications/131/codesAt.json?date="+b+"-12-31",!0),j.setRequestHeader("Accept","application/json"),j.send(),i=function(){return this.validator_seen_ids=[]},g=function(a,b,c){var d,e;return a&&a.match(/^\d\d?\.\d\d?\.\d\d(?:\d\d)?$/)?(e=a.split("."),2===e[2].length?e[2]=2e3+parseInt(e[2]):e[2]=parseInt(e[2]),e[1]=parseInt(e[1])-1,e[0]=parseInt(e[0]),d=new Date(e[2],e[1],e[0]),d.getFullYear()!==e[2]||d.getMonth()!==e[1]||d.getDate()!==e[0]?[!1,a+" finnes ikke."]:b>=d?d>=c?[d,!1]:[!1,"må være senere enn "+c.toLocaleDateString()]:[!1,"må være tidligere enn "+b.toLocaleDateString()]):[!1,"har ikke et gyldig format (dd.mm.åå)."]},h=function(e,f){var h,i,j,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z;if(y={},e.length<26)y[-1]="Forventet 26 felter. Hopper over denne raden.";else{for(j=l=0;25>=l;j=++l)e[j]=e[j].toString().replace(",","."),isNaN(e[j])||(e[j]=Math.floor(e[j]));switch(p=e[0],k.call(c,p)<0&&(y[0]="Studieforbundets nummer er ikke gyldig"),null===e[1]||e[1].toString().match(/^\d{0,3}$/)||(y[1]="Medlemsorganisasjon skal være blankt eller et siffer mellom 1 og 999."),q=e[2],k.call(a,q)<0&&(y[2]="Kommunenummeret finnes ikke"),e[3].toString().match(/^\d{1,7}$/)?(r=e[3]+"@"+e[0],k.call(this.validator_seen_ids,r)>=0&&(y[3]="Kursid må være unikt.")):y[3]="Kursid skal bestå av 7 siffer.",s=e[4],k.call(d,s)<0&&(y[4]="Emnekoden er ikke gyldig."),1!==(t=e[5])&&2!==t&&3!==t&&9!==t&&(y[5]="Nivå er ikke gyldig"),e[5]){case 1:10!==(u=e[6])&&11!==u&&20!==u&&30!==u&&99!==u&&(y[6]="Ugyldig eksamenskode for grunnivå");break;case 2:10!==(v=e[6])&&12!==v&&13!==v&&20!==v&&30!==v&&40!==v&&99!==v&&(y[6]="Ugyldig eksamenskode for videregående nivå");break;case 3:10!==(w=e[6])&&13!==w&&14!==w&&20!==w&&30!==w&&99!==w&&(y[6]="Ugyldig eksamenskode for høyere nivå");break;default:30!==(x=e[6])&&99!==x&&(y[6]="Ugyldig eksamenskode for uoppgitt nivå")}for(o=0,j=m=7;12>=m;j=++m)e[j]>=0||(y[j.toString()]="Kursdeltakere må være et postivt heltall"),o+=e[j];for(i=0,j=n=13;18>=n;j=++n)e[j]>=0||(y[j.toString()]="Kursdeltakere må være et postivt heltall"),i+=e[j];o+i>0||(y[-2]="Kurset må ha deltakere."),e[19]>=0||(y[19]="Antall menn med tilretteleggingstilskudd må være et positivt heltall"),e[19]<=o||(y[19]="Antall menn med tilretteleggingstilskudd skal ikke være større enn antall menn"),e[20]>=0||(y[20]="Antall kvinner med tilretteleggingstilskudd må være et positivt heltall"),e[20]<=i||(y[20]="Antall kvinner med tilretteleggingstilskudd skal ikke være større enn antall kvinner"),z=g(e[21],new Date(b,11,31),new Date(b-3,0,1)),z[0]||(y[21]="Startdato "+z[1]),h=g(e[22],new Date(b+1,1,20),z[0]?z[0]:new Date(b-3,0,1)),h[0]||(y[22]="Sluttdato "+h[1]),e[23]>=8||(y[23]="Kurset må ha minst 8 timer"),z[0]&&h[0]&&(24*(Math.round(Math.abs((z[0].getTime()-h[0].getTime())/864e5))+1)>=e[23]||(y[23]="Det er ikke "+e[23]+" timer innenfor kursets varighet.")),e[24]>=0||(y[24]="Timer med elektronisk kommunikasjon må være et positivt heltall."),e[24]<=e[23]/2||(y[24]="Fysiske samlinger skal utgjøre mer enn halvparten av totalt antall kurstimer."),e[25].toString().match(/^[123]$/)||(y[25]="Ugyldig kode for tidspunkt")}return Object.keys(y).length?(e.unshift(y,f),[!1,e]):(this.validator_seen_ids.push(e[3]+"@"+e[0]),[!0,e])}}).call(this);